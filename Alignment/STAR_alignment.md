## **STAR alignment**

After indexing the reads, the next step is to align them, which leads to the subsequent .sh and .sge scripts:

```{bash .sge, eval=FALSE}
#!/bin/bash
# Use current working directory
#$ -cwd
#
# Join stdout and stderr
#$ -j y
#
# Run job through bash shell
#$ -S /bin/bash
#
#You can edit the script since this line
#
# Your job name
$ -N fastqc_C2_T2
#
# Send an email after the job has finished
$ -m e
$ -M paurodriguez760@gmail.com
#
#
# If modules are needed, source modules environment (Do not delete the next lin$
. /etc/profile.d/modules.sh
#
# Add any modules you might require:
#
module load star/2.7.9a
cd /mnt/Guanina/bioinfo24/Equipo_rosa/scripts/
./alignment_STAR.sh
```

```{bash .sh, eval=FALSE}

#ruta en donde est√° el index de referencia
index=/mnt/Guanina/bioinfo24/Equipo_rosa/STAR_index

#ruta de los archivos de secuencias
FILES=/mnt/Guanina/bioinfo24/Equipo_rosa/data_trimmed/*_1_trimmed.fq

for f in $FILES
do
    base=$(basename $f _1_trimmed.fq)
    echo $base
    STAR --runThreadN 12 --genomeDir $index --readFilesIn $f /mnt/Guanina/bioinfo24/Equipo_rosa/data_trimmed/$base"_2_trimmed.fq" \
    --outSAMtype BAM SortedByCoordinate \
    --quantMode GeneCounts \
    --outFileNamePrefix /mnt/Guanina/bioinfo24/Equipo_rosa/STAR_output/$base
done
```


**Where:**

`for f in $FILES:` traverses each sequence file in variable FILES.

`base=$(basename $f _1_trimmed.fq):` extracts the base file name by removing the _1_trimmed.fq extension. This base name will be used later to name the output files.

`--runThreadN 12:` indicates that 12 processing threads should be used.

`--genomeDir $index:` specifies the path of the reference index.

`--readFilesIn $f /mnt/Guanina/bioinfo24/Equipo_rosa/data_trimmed/$base"_2_trimmed.fq" \:` specifies the input read files for STAR. 
`$f` represents read file 1, and /mnt/Guanina/bioinfo24/Equipo_rosa/data_trimmed/$base"_2_trimmed.fq" represents read file 2 corresponding to the same sample pair.

`--outSAMtype BAM SortedByCoordinate:` specifies the output format of alignment files as BAM files sorted by coordinates.

`--quantMode GeneCounts:`  performs quantification of gene expression and generates gene counts.

`--outFileNamePrefix /mnt/Guanina/bioinfo24/Equipo_rosa/STAR_output/$base:` specifies the location and prefix of the output files generated by STAR.


`done:` marks the end of the for loop.


Now, what **output** did the alignment process give us?
